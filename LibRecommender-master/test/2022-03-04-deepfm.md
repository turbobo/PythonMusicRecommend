reset_state("DeepFM")
deepfm = DeepFM("rating", data_info, embed_size=16, n_epochs=30,
lr=0.001, lr_decay=False, reg=None, batch_size=256,
num_neg=1, use_bn=False, dropout_rate=None,
hidden_units="256,256,256", tf_sess_config=None)

============================== DeepFM ==============================
Training start time: 2022-03-04 12:18:30
total params: 2,703,399 | embedding params: 2,551,569 | network params: 151,830
train: 100%|██████████| 6416/6416 [01:26<00:00, 74.14it/s]
eval_pred:   0%|          | 0/34 [00:00<?, ?it/s]Epoch 1 elapsed: 87.015s
train_loss: 0.0061
eval_pred: 100%|██████████| 34/34 [00:00<00:00, 63.98it/s]
eval rmse: 0.0332
eval mae: 0.0229
eval r2: 0.1314
==============================
train: 100%|██████████| 6416/6416 [01:23<00:00, 77.02it/s]
eval_pred:   0%|          | 0/34 [00:00<?, ?it/s]Epoch 2 elapsed: 83.729s
train_loss: 0.0045
eval_pred: 100%|██████████| 34/34 [00:00<00:00, 64.01it/s]
eval rmse: 0.0303
eval mae: 0.0143
eval r2: 0.2805
==============================
train: 100%|██████████| 6416/6416 [01:24<00:00, 76.31it/s]
eval_pred:   0%|          | 0/34 [00:00<?, ?it/s]Epoch 3 elapsed: 84.482s
train_loss: 0.0008
eval_pred: 100%|██████████| 34/34 [00:00<00:00, 64.00it/s]
eval rmse: 0.0307
eval mae: 0.0150
eval r2: 0.2598
==============================
train: 100%|██████████| 6416/6416 [01:24<00:00, 75.66it/s]
eval_pred:   0%|          | 0/34 [00:00<?, ?it/s]Epoch 4 elapsed: 85.238s
train_loss: 0.0007
eval_pred: 100%|██████████| 34/34 [00:00<00:00, 72.54it/s]
eval rmse: 0.0308
eval mae: 0.0140
eval r2: 0.2550
==============================
train: 100%|██████████| 6416/6416 [01:24<00:00, 75.73it/s]
eval_pred:   0%|          | 0/34 [00:00<?, ?it/s]Epoch 5 elapsed: 85.084s
train_loss: 0.0006
eval_pred: 100%|██████████| 34/34 [00:00<00:00, 65.93it/s]
eval rmse: 0.0319
eval mae: 0.0149
eval r2: 0.2012
==============================
train: 100%|██████████| 6416/6416 [01:22<00:00, 77.37it/s]
eval_pred:   0%|          | 0/34 [00:00<?, ?it/s]Epoch 6 elapsed: 83.285s
train_loss: 0.0006
eval_pred: 100%|██████████| 34/34 [00:00<00:00, 70.20it/s]
eval rmse: 0.0342
eval mae: 0.0194
eval r2: 0.0825
==============================
train: 100%|██████████| 6416/6416 [01:23<00:00, 77.18it/s]
eval_pred:   0%|          | 0/34 [00:00<?, ?it/s]Epoch 7 elapsed: 83.512s
train_loss: 0.0005
eval_pred: 100%|██████████| 34/34 [00:00<00:00, 72.54it/s]
eval rmse: 0.0331
eval mae: 0.0159
eval r2: 0.1379
==============================
train: 100%|██████████| 6416/6416 [01:22<00:00, 78.10it/s]
eval_pred:   0%|          | 0/34 [00:00<?, ?it/s]Epoch 8 elapsed: 82.506s
train_loss: 0.0004
eval_pred: 100%|██████████| 34/34 [00:00<00:00, 68.00it/s]
eval rmse: 0.0360
eval mae: 0.0211
eval r2: -0.0190
==============================
train: 100%|██████████| 6416/6416 [01:25<00:00, 74.65it/s]
eval_pred:   0%|          | 0/34 [00:00<?, ?it/s]Epoch 9 elapsed: 86.351s
train_loss: 0.0004
eval_pred: 100%|██████████| 34/34 [00:00<00:00, 67.15it/s]
eval rmse: 0.0347
eval mae: 0.0165
eval r2: 0.0526
==============================
train: 100%|██████████| 6416/6416 [01:29<00:00, 72.02it/s]
eval_pred:   0%|          | 0/34 [00:00<?, ?it/s]Epoch 10 elapsed: 89.548s
train_loss: 0.0004
eval_pred: 100%|██████████| 34/34 [00:00<00:00, 67.54it/s]
eval rmse: 0.0361
eval mae: 0.0174
eval r2: -0.0247
==============================
train: 100%|██████████| 6416/6416 [01:26<00:00, 74.46it/s]
eval_pred:   0%|          | 0/34 [00:00<?, ?it/s]Epoch 11 elapsed: 86.553s
train_loss: 0.0003
eval_pred: 100%|██████████| 34/34 [00:00<00:00, 68.01it/s]
eval rmse: 0.0356
eval mae: 0.0169
eval r2: 0.0061
==============================
train: 100%|██████████| 6416/6416 [01:25<00:00, 74.76it/s]
eval_pred:   0%|          | 0/34 [00:00<?, ?it/s]Epoch 12 elapsed: 86.195s
train_loss: 0.0003
eval_pred: 100%|██████████| 34/34 [00:00<00:00, 62.52it/s]
eval rmse: 0.0380
eval mae: 0.0208
eval r2: -0.1345
==============================
train: 100%|██████████| 6416/6416 [01:28<00:00, 72.69it/s]
eval_pred:   0%|          | 0/34 [00:00<?, ?it/s]Epoch 13 elapsed: 88.660s
train_loss: 0.0002
eval_pred: 100%|██████████| 34/34 [00:00<00:00, 63.51it/s]
eval rmse: 0.0352
eval mae: 0.0177
eval r2: 0.0252
==============================
train: 100%|██████████| 6416/6416 [01:31<00:00, 70.33it/s]
eval_pred:   0%|          | 0/34 [00:00<?, ?it/s]Epoch 14 elapsed: 91.632s
train_loss: 0.0002
eval_pred: 100%|██████████| 34/34 [00:00<00:00, 63.45it/s]
eval rmse: 0.0357
eval mae: 0.0163
eval r2: -0.0005
==============================
train: 100%|██████████| 6416/6416 [01:27<00:00, 73.03it/s]
eval_pred:   0%|          | 0/34 [00:00<?, ?it/s]Epoch 15 elapsed: 88.246s
train_loss: 0.0002
eval_pred: 100%|██████████| 34/34 [00:00<00:00, 65.95it/s]
eval rmse: 0.0362
eval mae: 0.0162
eval r2: -0.0318
==============================
train: 100%|██████████| 6416/6416 [01:25<00:00, 75.44it/s]
eval_pred:   0%|          | 0/34 [00:00<?, ?it/s]Epoch 16 elapsed: 85.395s
train_loss: 0.0002
eval_pred: 100%|██████████| 34/34 [00:00<00:00, 65.94it/s]
eval rmse: 0.0359
eval mae: 0.0166
eval r2: -0.0129
==============================
train: 100%|██████████| 6416/6416 [01:24<00:00, 76.17it/s]
eval_pred:   0%|          | 0/34 [00:00<?, ?it/s]Epoch 17 elapsed: 84.581s
train_loss: 0.0002
eval_pred: 100%|██████████| 34/34 [00:00<00:00, 65.94it/s]
eval rmse: 0.0360
eval mae: 0.0175
eval r2: -0.0196
==============================
train: 100%|██████████| 6416/6416 [01:21<00:00, 78.67it/s]
eval_pred:   0%|          | 0/34 [00:00<?, ?it/s]Epoch 18 elapsed: 81.920s
train_loss: 0.0001
eval_pred: 100%|██████████| 34/34 [00:00<00:00, 65.94it/s]
eval rmse: 0.0358
eval mae: 0.0160
eval r2: -0.0047
==============================
train: 100%|██████████| 6416/6416 [01:22<00:00, 78.10it/s]
eval_pred:   0%|          | 0/34 [00:00<?, ?it/s]Epoch 19 elapsed: 82.503s
train_loss: 0.0001
eval_pred: 100%|██████████| 34/34 [00:00<00:00, 65.94it/s]
eval rmse: 0.0351
eval mae: 0.0158
eval r2: 0.0320
==============================
train: 100%|██████████| 6416/6416 [01:22<00:00, 77.59it/s]
eval_pred:   0%|          | 0/34 [00:00<?, ?it/s]Epoch 20 elapsed: 83.059s
train_loss: 0.0001
eval_pred: 100%|██████████| 34/34 [00:00<00:00, 65.94it/s]
eval rmse: 0.0352
eval mae: 0.0157
eval r2: 0.0256
==============================
train: 100%|██████████| 6416/6416 [01:22<00:00, 77.57it/s]
eval_pred:   0%|          | 0/34 [00:00<?, ?it/s]Epoch 21 elapsed: 83.065s
train_loss: 0.0001
eval_pred: 100%|██████████| 34/34 [00:00<00:00, 67.67it/s]
eval rmse: 0.0349
eval mae: 0.0156
eval r2: 0.0437
==============================
train: 100%|██████████| 6416/6416 [01:23<00:00, 76.88it/s]
eval_pred:   0%|          | 0/34 [00:00<?, ?it/s]Epoch 22 elapsed: 83.809s
train_loss: 0.0001
eval_pred: 100%|██████████| 34/34 [00:00<00:00, 64.00it/s]
eval rmse: 0.0350
eval mae: 0.0155
eval r2: 0.0393
==============================
train: 100%|██████████| 6416/6416 [01:23<00:00, 77.10it/s]
eval_pred:   0%|          | 0/34 [00:00<?, ?it/s]Epoch 23 elapsed: 83.571s
train_loss: 0.0001
eval_pred: 100%|██████████| 34/34 [00:00<00:00, 65.94it/s]
eval rmse: 0.0361
eval mae: 0.0160
eval r2: -0.0236
==============================
train: 100%|██████████| 6416/6416 [01:23<00:00, 76.93it/s]
eval_pred:   0%|          | 0/34 [00:00<?, ?it/s]Epoch 24 elapsed: 83.758s
train_loss: 0.0001
eval_pred: 100%|██████████| 34/34 [00:00<00:00, 64.00it/s]
eval rmse: 0.0350
eval mae: 0.0161
eval r2: 0.0347
==============================
train: 100%|██████████| 6416/6416 [01:23<00:00, 76.47it/s]
eval_pred:   0%|          | 0/34 [00:00<?, ?it/s]Epoch 25 elapsed: 84.260s
train_loss: 0.0001
eval_pred: 100%|██████████| 34/34 [00:00<00:00, 67.96it/s]
eval rmse: 0.0352
eval mae: 0.0170
eval r2: 0.0257
==============================
train: 100%|██████████| 6416/6416 [01:23<00:00, 76.44it/s]
eval_pred:   0%|          | 0/34 [00:00<?, ?it/s]Epoch 26 elapsed: 84.290s
train_loss: 0.0001
eval_pred: 100%|██████████| 34/34 [00:00<00:00, 65.94it/s]
eval rmse: 0.0357
eval mae: 0.0168
eval r2: -0.0042
==============================
train: 100%|██████████| 6416/6416 [01:23<00:00, 76.61it/s]
eval_pred:   0%|          | 0/34 [00:00<?, ?it/s]Epoch 27 elapsed: 84.102s
train_loss: 0.0001
eval_pred: 100%|██████████| 34/34 [00:00<00:00, 65.95it/s]
eval rmse: 0.0349
eval mae: 0.0166
eval r2: 0.0431
==============================
train: 100%|██████████| 6416/6416 [01:24<00:00, 76.27it/s]
eval_pred:   0%|          | 0/34 [00:00<?, ?it/s]Epoch 28 elapsed: 84.469s
train_loss: 0.0001
eval_pred: 100%|██████████| 34/34 [00:00<00:00, 68.00it/s]
eval rmse: 0.0345
eval mae: 0.0153
eval r2: 0.0619
==============================
train: 100%|██████████| 6416/6416 [01:23<00:00, 76.40it/s]
eval_pred:   0%|          | 0/34 [00:00<?, ?it/s]Epoch 29 elapsed: 84.335s
train_loss: 0.0001
eval_pred: 100%|██████████| 34/34 [00:00<00:00, 62.17it/s]
eval rmse: 0.0349
eval mae: 0.0156
eval r2: 0.0440
==============================
train: 100%|██████████| 6416/6416 [01:25<00:00, 75.25it/s]
eval_pred:   0%|          | 0/34 [00:00<?, ?it/s]Epoch 30 elapsed: 85.713s
train_loss: 0.0001
eval_pred: 100%|██████████| 34/34 [00:00<00:00, 58.81it/s]
eval rmse: 0.0340
eval mae: 0.0150
eval r2: 0.0910
==============================

18-27 平均0.03529